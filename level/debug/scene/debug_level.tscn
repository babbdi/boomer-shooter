[gd_scene load_steps=34 format=3 uid="uid://c1s5vdgssdq6u"]

[ext_resource type="PackedScene" uid="uid://dlbxu4t873ohg" path="res://level/debug/blend/debugLevel.blend" id="1_b510y"]
[ext_resource type="Texture2D" uid="uid://6gm72fw3kwrc" path="res://level/debug/scene/lilienstein_2k.hdr" id="2_8makj"]
[ext_resource type="Texture2D" uid="uid://bmo3i6smairbs" path="res://textures/level/debug/debugRed.jpg" id="3_dlvtp"]
[ext_resource type="PackedScene" uid="uid://ca0wevg1lb4rx" path="res://level/props/water/WaterMaker3D/WaterMaker3D.tscn" id="4_54gt6"]
[ext_resource type="Texture2D" uid="uid://rst88ws2tkv0" path="res://textures/level/debug/debugPink.jpg" id="5_cjnfy"]
[ext_resource type="Texture2D" uid="uid://c25anvq8o4ssi" path="res://textures/level/debug/debugBlue.jpg" id="6_7cor3"]
[ext_resource type="Texture2D" uid="uid://cs20r6orwribq" path="res://textures/level/debug/debugOrange.jpg" id="6_r5fvd"]
[ext_resource type="Script" uid="uid://qpnyuvqel72k" path="res://level/props/water/FloatableRigidBody3D.gd" id="8_wg66v"]
[ext_resource type="PackedScene" uid="uid://iuv50705wyhf" path="res://level/debug/scene/debug_button.tscn" id="9_r5fvd"]
[ext_resource type="Script" uid="uid://bdb2ydo0awb0r" path="res://characters/player/interactableComponent.gd" id="10_iykvd"]

[sub_resource type="PanoramaSkyMaterial" id="PanoramaSkyMaterial_e3bb1"]
panorama = ExtResource("2_8makj")

[sub_resource type="Sky" id="Sky_angal"]
sky_material = SubResource("PanoramaSkyMaterial_e3bb1")

[sub_resource type="Environment" id="Environment_e3bb1"]
background_mode = 2
sky = SubResource("Sky_angal")
tonemap_mode = 2
glow_enabled = true
volumetric_fog_enabled = true
volumetric_fog_density = 0.0
volumetric_fog_albedo = Color(0.0130086, 0.248922, 0.486239, 1)

[sub_resource type="Curve3D" id="Curve3D_7cor3"]
_data = {
"points": PackedVector3Array(0, 13.8461, -0.227917, 0, -13.8461, 0.227917, 0.394653, -0.269494, 3.27743, 0, 1.50152, 2.97469, 0, -1.50152, -2.97469, 0.394645, -21.6322, -6.79563, 0, 0, 0, 0, 0, 0, 0.394645, -31.4252, -24.8551, 0, -0.321869, 10.2534, 0, 0.321869, -10.2534, 0.394645, -38.2124, -48.4237, 0, -3.1284, 5.42245, 0, 3.1284, -5.42245, 0.394645, -26.3614, -74.4695, 3.05176e-05, -5.79149, 5.33124, -3.05176e-05, 5.79149, -5.33124, 0.130947, -4.06404, -96.964, -3.05176e-05, -8.82646, 8.5894, 3.05176e-05, 8.82646, -8.5894, -0.000588399, 15.2036, -116.266),
"tilts": PackedFloat32Array(0, 0, 0, 0, 0, 0, 0)
}
point_count = 7

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_r5fvd"]
albedo_texture = ExtResource("3_dlvtp")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_iykvd"]

[sub_resource type="FastNoiseLite" id="FastNoiseLite_wg66v"]
resource_local_to_scene = true

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_hx6qw"]
resource_local_to_scene = true
seamless = true
as_normal_map = true
noise = SubResource("FastNoiseLite_wg66v")

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_riu67"]
resource_local_to_scene = true
seamless = true
as_normal_map = true
noise = SubResource("FastNoiseLite_wg66v")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_xcv0f"]
resource_local_to_scene = true
transparency = 1
cull_mode = 2
depth_draw_mode = 1
albedo_color = Color(0.309804, 0.541176, 0.866667, 0.388235)
roughness = 0.0
normal_enabled = true
normal_texture = SubResource("NoiseTexture2D_hx6qw")
refraction_enabled = true
refraction_texture = SubResource("NoiseTexture2D_riu67")
uv1_scale = Vector3(0.04, 0.04, 0.04)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_6lpfg"]
albedo_texture = ExtResource("6_7cor3")

[sub_resource type="BoxMesh" id="BoxMesh_xcv0f"]

[sub_resource type="BoxShape3D" id="BoxShape3D_6lpfg"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_vr0vg"]
albedo_texture = ExtResource("6_r5fvd")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_odf1y"]
albedo_texture = ExtResource("3_dlvtp")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_kox6g"]
albedo_texture = ExtResource("5_cjnfy")

[sub_resource type="GDScript" id="GDScript_r5fvd"]
script/source = "extends AnimatableBody3D

@export var open := false :
	set(v):
		if v != open:
			open = v
			update_door()

func update_door() -> void:
	if open:
		$AnimationPlayer.play(\"open\")
	else:
		$AnimationPlayer.play_backwards(\"open\")
	$AnimationPlayer.set_active(true)

func toggle_open() -> void:
	open = !open
"

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_hpii2"]
albedo_texture = ExtResource("3_dlvtp")

[sub_resource type="BoxMesh" id="BoxMesh_r5fvd"]
size = Vector3(0.17, 2.21, 1.26)

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_r5fvd"]
points = PackedVector3Array(-0.10254, -1.12254, -0.647413, 0.107937, 1.12254, 0.65027, -0.10254, 1.12254, 0.65027, 0.107937, -1.12254, 0.65027, 0.107937, 1.12254, -0.647413, -0.10254, 1.12254, -0.647413, -0.10254, -1.12254, 0.65027, 0.107937, -1.12254, -0.647413)

[sub_resource type="Animation" id="Animation_iykvd"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(0, 0, 0)]
}

[sub_resource type="Animation" id="Animation_r5fvd"]
resource_name = "open"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:rotation")
tracks/0/interp = 2
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(0, -3.57628e-06, 0), Vector3(0, 1.74533, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_iykvd"]
_data = {
&"RESET": SubResource("Animation_iykvd"),
&"open": SubResource("Animation_r5fvd")
}

[node name="debugLevel" instance=ExtResource("1_b510y")]

[node name="WorldEnvironment" type="WorldEnvironment" parent="." index="0"]
environment = SubResource("Environment_e3bb1")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="." index="1"]
transform = Transform3D(-0.866023, -0.433016, 0.250001, 0, 0.499998, 0.866027, -0.500003, 0.749999, -0.43301, 0, 0, 0)
shadow_enabled = true

[node name="Path3D" type="Path3D" parent="." index="10"]
transform = Transform3D(6.43132, 0, 0, 0, 0.661337, 0, 0, 0, 1, 0, 0, -28.7654)
curve = SubResource("Curve3D_7cor3")

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="Path3D" index="0"]
material_override = SubResource("StandardMaterial3D_r5fvd")
use_collision = true
polygon = PackedVector2Array(0, 0, 0, 1, -5.82, 0.53)
mode = 2
path_node = NodePath("..")
path_interval_type = 0
path_interval = 1.0
path_simplify_angle = 0.0
path_rotation = 2
path_rotation_accurate = false
path_local = true
path_continuous_u = true
path_u_distance = 1.0
path_joined = false
material = SubResource("StandardMaterial3D_iykvd")

[node name="WaterMaker3D" parent="." index="11" instance=ExtResource("4_54gt6")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 12.891, -7.52733, -19.0932)
size = Vector3(26.2921, 14.7611, 13.2667)
material = SubResource("StandardMaterial3D_xcv0f")

[node name="FloatingRigidBody3D5" type="RigidBody3D" parent="." index="12"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.2, 0.8, -17.7)
mass = 1.5
script = ExtResource("8_wg66v")
metadata/_custom_type_script = "uid://qpnyuvqel72k"

[node name="MeshInstance3D" type="MeshInstance3D" parent="FloatingRigidBody3D5" index="0"]
material_override = SubResource("StandardMaterial3D_6lpfg")
mesh = SubResource("BoxMesh_xcv0f")

[node name="CollisionShape3D" type="CollisionShape3D" parent="FloatingRigidBody3D5" index="1"]
shape = SubResource("BoxShape3D_6lpfg")

[node name="FloatingRigidBody3D6" type="RigidBody3D" parent="." index="13"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.3, 0.8, -20.1)
mass = 0.5
script = ExtResource("8_wg66v")
metadata/_custom_type_script = "uid://qpnyuvqel72k"

[node name="MeshInstance3D" type="MeshInstance3D" parent="FloatingRigidBody3D6" index="0"]
material_override = SubResource("StandardMaterial3D_6lpfg")
mesh = SubResource("BoxMesh_xcv0f")

[node name="CollisionShape3D" type="CollisionShape3D" parent="FloatingRigidBody3D6" index="1"]
shape = SubResource("BoxShape3D_6lpfg")

[node name="RigidBody3D2" type="RigidBody3D" parent="." index="14"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.3, 0.8, -9.1)
mass = 5.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="RigidBody3D2" index="0"]
material_override = SubResource("StandardMaterial3D_vr0vg")
mesh = SubResource("BoxMesh_xcv0f")

[node name="CollisionShape3D" type="CollisionShape3D" parent="RigidBody3D2" index="1"]
shape = SubResource("BoxShape3D_6lpfg")

[node name="RigidBody3D3" type="RigidBody3D" parent="." index="15"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.3, 0.8, -11.1)
mass = 10.0

[node name="MeshInstance3D" type="MeshInstance3D" parent="RigidBody3D3" index="0"]
material_override = SubResource("StandardMaterial3D_odf1y")
mesh = SubResource("BoxMesh_xcv0f")

[node name="CollisionShape3D" type="CollisionShape3D" parent="RigidBody3D3" index="1"]
shape = SubResource("BoxShape3D_6lpfg")

[node name="FloatingRigidBody3D4" type="RigidBody3D" parent="." index="16"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.3003, 0.8, -13.1181)
mass = 15.0
script = ExtResource("8_wg66v")
metadata/_custom_type_script = "uid://qpnyuvqel72k"

[node name="MeshInstance3D" type="MeshInstance3D" parent="FloatingRigidBody3D4" index="0"]
material_override = SubResource("StandardMaterial3D_kox6g")
mesh = SubResource("BoxMesh_xcv0f")

[node name="CollisionShape3D" type="CollisionShape3D" parent="FloatingRigidBody3D4" index="1"]
shape = SubResource("BoxShape3D_6lpfg")

[node name="FloatingRigidBody3D8" type="RigidBody3D" parent="." index="17"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.3003, 0.8, -22.1181)
script = ExtResource("8_wg66v")
metadata/_custom_type_script = "uid://qpnyuvqel72k"

[node name="MeshInstance3D" type="MeshInstance3D" parent="FloatingRigidBody3D8" index="0"]
material_override = SubResource("StandardMaterial3D_kox6g")
mesh = SubResource("BoxMesh_xcv0f")

[node name="CollisionShape3D" type="CollisionShape3D" parent="FloatingRigidBody3D8" index="1"]
shape = SubResource("BoxShape3D_6lpfg")

[node name="debug_button" parent="." index="19" instance=ExtResource("9_r5fvd")]
transform = Transform3D(-2.18557e-08, 0.5, 0, -0.5, -2.18557e-08, 0, 0, 0, 0.5, -8.90113, 1.0867, -19.9408)

[node name="porta" type="AnimatableBody3D" parent="." index="20"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -9.1, 0, -20.9)
script = SubResource("GDScript_r5fvd")

[node name="MeshInstance3D" type="MeshInstance3D" parent="porta" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -0.6)
material_override = SubResource("StandardMaterial3D_hpii2")
mesh = SubResource("BoxMesh_r5fvd")

[node name="CollisionShape3D" type="CollisionShape3D" parent="porta" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, -0.6)
shape = SubResource("ConvexPolygonShape3D_r5fvd")

[node name="AnimationPlayer" type="AnimationPlayer" parent="porta" index="2"]
libraries = {
&"": SubResource("AnimationLibrary_iykvd")
}

[node name="InteractableComponent" type="Node" parent="porta" index="3"]
script = ExtResource("10_iykvd")
metadata/_custom_type_script = "uid://bdb2ydo0awb0r"

[connection signal="interacted" from="debug_button/InteractableComponent" to="porta" method="toggle_open"]
[connection signal="interacted" from="debug_button/InteractableComponent" to="debug_button/debugButton/AnimationPlayer" method="play" binds= ["press"]]
[connection signal="interacted" from="porta/InteractableComponent" to="porta" method="toggle_open"]

[editable path="debug_button"]
[editable path="debug_button/debugButton"]
